<script>
  document.addEventListener("DOMContentLoaded", function () {
    const sheetId = "1okaLOcbfLmMGi3zZ5K5YkVbHoCDCAdu9m_TaqSsb_G0";
    const sheetName = "Programação dos Eventos SAD 2026";

    const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(sheetName)}`;

    fetch(url)
      .then(res => res.text())
      .then(text => {
        const json = JSON.parse(text.substring(47).slice(0, -2));
        const rows = json.table.rows;
        const tabela = document.getElementById("listaEventos");

        tabela.innerHTML = "";

        rows.forEach(r => {
          tabela.innerHTML += `
            <tr>
              <td>${r.c[0]?.v || ""}</td>
              <td>${r.c[1]?.v || ""}</td>
              <td>${r.c[2]?.v || ""} - ${r.c[3]?.v || ""}</td>
              <td>${r.c[4]?.v || ""}</td>
              <td>${r.c[5]?.v || ""}</td>
              <td>${r.c[6]?.v || ""}</td>
              <td>${r.c[7]?.v || ""}</td>
              <td>${r.c[8]?.v || ""}</td>
              <td>${r.c[9]?.v || ""}</td>
            </tr>
          `;
        });
      })
      .catch(err => {
        console.error("Erro ao carregar planilha:", err);
      });
  });
</script>
