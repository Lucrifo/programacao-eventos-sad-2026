<script>
document.addEventListener("DOMContentLoaded", function () {

  const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQgeJ4mmymfEyWrE17xIupdRAMmW8Dy6xRpVqUIdX98v4O04iERPKuqKj0lnkj4Ps5Do7VzIfRwvcNc/pub?output=csv";

  fetch(csvUrl)
    .then(response => response.text())
    .then(text => {
      const linhas = text.split("\n").slice(1);
      const tabela = document.getElementById("listaEventos");

      if (!tabela) return;

      tabela.innerHTML = "";

      linhas.forEach(linha => {
        if (!linha.trim()) return;

        const col = linha.split(";");

        if (col.length < 9) return;

        tabela.innerHTML += `
          <tr>
            <td>${col[0]}</td>
            <td>${col[1]}</td>
            <td>${col[2]} - ${col[3]}</td>
            <td>${col[4]}</td>
            <td>${col[5]}</td>
            <td>${col[6]}</td>
            <td>${col[7]}</td>
            <td>${col[8]}</td>
            <td>${col[9] || ""}</td>
          </tr>
        `;
      });
    })
    .catch(err => {
      console.error("Erro ao carregar a planilha:", err);
    });

});
</script>
